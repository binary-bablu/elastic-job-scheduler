-- Table: public.job_schedule_definitions

-- DROP TABLE IF EXISTS public.job_schedule_definitions;

CREATE TABLE IF NOT EXISTS public.job_schedule_definitions
(
    id integer NOT NULL DEFAULT nextval('job_info_id_seq'::regclass),
    job_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    cron_expression character varying(255) COLLATE pg_catalog."default",
    script_path character varying(255) COLLATE pg_catalog."default",
    description character varying(255) COLLATE pg_catalog."default",
    created_at timestamp with time zone DEFAULT now(),
    job_group character varying(255) COLLATE pg_catalog."default",
    updated_at timestamp(6) without time zone DEFAULT now(),
    status character varying(50) COLLATE pg_catalog."default",
    retry_max_attempts integer,
    retry_initial_delay_ms integer,
    retry_strategy character varying(20) COLLATE pg_catalog."default",
    retry_multiplier integer,
    timeout integer,
    non_retryable_exit_codes character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT job_info_pkey PRIMARY KEY (id)
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS public.job_schedule_definitions
    OWNER to postgres;
    
    -- Table: public.job_parameters

-- DROP TABLE IF EXISTS public.job_parameters;

CREATE TABLE IF NOT EXISTS public.job_parameters
(
    id integer NOT NULL DEFAULT nextval('job_parameters_job_id_seq'::regclass),
    param_key character varying(255) COLLATE pg_catalog."default",
    param_value character varying(255) COLLATE pg_catalog."default",
    description character varying(1000) COLLATE pg_catalog."default",
    job_id integer,
    CONSTRAINT job_parameters_pkey PRIMARY KEY (id),
    CONSTRAINT fkk2esiheg5u83uumjpra5h2h1j FOREIGN KEY (job_id)
        REFERENCES public.job_schedule_definitions (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS public.job_parameters
    OWNER to postgres;
    
    -- Table: public.job_executions

-- DROP TABLE IF EXISTS public.job_executions;

CREATE TABLE IF NOT EXISTS public.job_executions
(
    id integer NOT NULL DEFAULT nextval('job_exec_info_exec_id_seq'::regclass),
    status character varying(255) COLLATE pg_catalog."default",
    queued_start_time timestamp with time zone,
    job_id integer,
    exec_start_time timestamp with time zone,
    exec_end_time timestamp with time zone,
    queued_end_time timestamp with time zone,
    retry_attempt_number integer,
    sent_to_dlq character varying(10) COLLATE pg_catalog."default",
    error_message text COLLATE pg_catalog."default",
    output_message text COLLATE pg_catalog."default",
    is_retry_attempt character varying(10) COLLATE pg_catalog."default",
    CONSTRAINT job_exec_info_pkey PRIMARY KEY (id),
    CONSTRAINT fk19gpxw8qi8ti2qscbacx5alg4 FOREIGN KEY (job_id)
        REFERENCES public.job_schedule_definitions (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS public.job_executions
    OWNER to postgres;
    
    -- Table: public.job_execution_heartbeat_info

-- DROP TABLE IF EXISTS public.job_execution_heartbeat_info;

CREATE TABLE IF NOT EXISTS public.job_execution_heartbeat_info
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    agent_id character varying(255) COLLATE pg_catalog."default",
    current_active_jobs integer,
    last_heart_beat character varying(255) COLLATE pg_catalog."default",
    max_concurrent_jobs integer,
    status character varying(255) COLLATE pg_catalog."default",
    CONSTRAINT job_execution_heartbeat_info_pkey PRIMARY KEY (id)
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS public.job_execution_heartbeat_info
    OWNER to postgres;